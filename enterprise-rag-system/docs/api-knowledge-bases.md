# çŸ¥è¯†åº“ç®¡ç†æ¨¡å— API æ–‡æ¡£

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

çŸ¥è¯†åº“ç®¡ç†æ¨¡å—æä¾›çŸ¥è¯†åº“çš„åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ç­‰åŠŸèƒ½ï¼Œæ”¯æŒæƒé™æ§åˆ¶å’Œå¯è§æ€§ç®¡ç†ã€‚

**åŸºç¡€è·¯å¾„**: `/api/v1/knowledge-bases`

## ğŸ” æƒé™è¯´æ˜

- **knowledge_base:read**: è¯»å–çŸ¥è¯†åº“æƒé™
- **knowledge_base:write**: åˆ›å»ºçŸ¥è¯†åº“æƒé™
- **knowledge_base:delete**: åˆ é™¤çŸ¥è¯†åº“æƒé™
- **knowledge_base:manage**: ç®¡ç†çŸ¥è¯†åº“æƒé™

## ğŸ“š æ¥å£åˆ—è¡¨

### 1. è·å–çŸ¥è¯†åº“åˆ—è¡¨

**æ¥å£åç§°**: è·å–çŸ¥è¯†åº“åˆ—è¡¨
**åŠŸèƒ½æè¿°**: è·å–ç”¨æˆ·æœ‰æƒè®¿é—®çš„çŸ¥è¯†åº“åˆ—è¡¨
**æ¥å£åœ°å€**: `/api/v1/knowledge-bases/`
**è¯·æ±‚æ–¹å¼**: GET
**è®¤è¯**: éœ€è¦Bearer Token + knowledge_base:readæƒé™

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|-----|------|--------|
| page | int | å¦ | é¡µç ï¼ˆé»˜è®¤1ï¼‰ | 1 |
| size | int | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤20ï¼Œæœ€å¤§100ï¼‰ | 20 |
| search | string | å¦ | æœç´¢å…³é”®è¯ï¼ˆçŸ¥è¯†åº“åç§°ï¼‰ | æŠ€æœ¯æ–‡æ¡£ |
| knowledge_type | string | å¦ | çŸ¥è¯†åº“ç±»å‹è¿‡æ»¤ | general |

#### å“åº”å‚æ•°
```json
{
  "items": [
    {
      "id": 1,
      "name": "æŠ€æœ¯æ–‡æ¡£çŸ¥è¯†åº“",
      "description": "å­˜å‚¨æŠ€æœ¯ç›¸å…³æ–‡æ¡£",
      "knowledge_type": "general",
      "visibility": "private",
      "owner_id": 1,
      "created_at": "2024-01-01T12:00:00Z",
      "updated_at": "2024-01-01T12:00:00Z"
    }
  ],
  "total": 10,
  "page": 1,
  "size": 20,
  "pages": 1
}
```

| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|------|--------|
| items | array | çŸ¥è¯†åº“åˆ—è¡¨ | è§çŸ¥è¯†åº“å¯¹è±¡ |
| total | int | æ€»æ•°é‡ | 10 |
| page | int | å½“å‰é¡µç  | 1 |
| size | int | æ¯é¡µæ•°é‡ | 20 |
| pages | int | æ€»é¡µæ•° | 1 |

#### çŸ¥è¯†åº“å¯¹è±¡å­—æ®µè¯´æ˜
| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|------|--------|
| id | int | çŸ¥è¯†åº“ID | 1 |
| name | string | çŸ¥è¯†åº“åç§° | æŠ€æœ¯æ–‡æ¡£çŸ¥è¯†åº“ |
| description | string | çŸ¥è¯†åº“æè¿° | å­˜å‚¨æŠ€æœ¯ç›¸å…³æ–‡æ¡£ |
| knowledge_type | string | çŸ¥è¯†åº“ç±»å‹ | general |
| visibility | string | å¯è§æ€§ï¼ˆpublic/privateï¼‰ | private |
| owner_id | int | æ‰€æœ‰è€…ID | 1 |
| created_at | string | åˆ›å»ºæ—¶é—´ | 2024-01-01T12:00:00Z |
| updated_at | string | æ›´æ–°æ—¶é—´ | 2024-01-01T12:00:00Z |

---

### 2. åˆ›å»ºçŸ¥è¯†åº“

**æ¥å£åç§°**: åˆ›å»ºçŸ¥è¯†åº“  
**åŠŸèƒ½æè¿°**: åˆ›å»ºæ–°çš„çŸ¥è¯†åº“  
**æ¥å£åœ°å€**: `/api/v1/knowledge-bases/`  
**è¯·æ±‚æ–¹å¼**: POST  
**è®¤è¯**: éœ€è¦Bearer Token + knowledge_base:writeæƒé™

#### è¯·æ±‚å‚æ•°
```json
{
  "name": "æ–°çŸ¥è¯†åº“",
  "description": "è¿™æ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†åº“",
  "is_public": false
}
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|-----|------|--------|
| name | string | æ˜¯ | çŸ¥è¯†åº“åç§°ï¼ˆ1-100å­—ç¬¦ï¼‰ | æ–°çŸ¥è¯†åº“ |
| description | string | å¦ | çŸ¥è¯†åº“æè¿° | è¿™æ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†åº“ |
| is_public | bool | å¦ | æ˜¯å¦å…¬å¼€ï¼ˆé»˜è®¤falseï¼‰ | false |

#### å“åº”å‚æ•°
```json
{
  "id": 2,
  "name": "æ–°çŸ¥è¯†åº“",
  "description": "è¿™æ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†åº“",
  "knowledge_type": "general",
  "visibility": "private",
  "owner_id": 1,
  "created_at": "2024-01-01T12:00:00Z",
  "updated_at": "2024-01-01T12:00:00Z"
}
```

#### é”™è¯¯ç 
- `400`: çŸ¥è¯†åº“åç§°ä¸èƒ½ä¸ºç©º / çŸ¥è¯†åº“åç§°å·²å­˜åœ¨
- `403`: æƒé™ä¸è¶³

---

### 3. è·å–çŸ¥è¯†åº“è¯¦æƒ…

**æ¥å£åç§°**: è·å–çŸ¥è¯†åº“è¯¦æƒ…  
**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šçŸ¥è¯†åº“çš„è¯¦ç»†ä¿¡æ¯  
**æ¥å£åœ°å€**: `/api/v1/knowledge-bases/{kb_id}`  
**è¯·æ±‚æ–¹å¼**: GET  
**è®¤è¯**: éœ€è¦Bearer Token + knowledge_base:readæƒé™

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|-----|------|--------|
| kb_id | int | æ˜¯ | çŸ¥è¯†åº“IDï¼ˆè·¯å¾„å‚æ•°ï¼‰ | 1 |

#### å“åº”å‚æ•°
```json
{
  "id": 1,
  "name": "æŠ€æœ¯æ–‡æ¡£çŸ¥è¯†åº“",
  "description": "å­˜å‚¨æŠ€æœ¯ç›¸å…³æ–‡æ¡£",
  "knowledge_type": "general",
  "visibility": "private",
  "owner_id": 1,
  "created_at": "2024-01-01T12:00:00Z",
  "updated_at": "2024-01-01T12:00:00Z"
}
```

#### é”™è¯¯ç 
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `403`: æƒé™ä¸è¶³

---

### 4. æ›´æ–°çŸ¥è¯†åº“

**æ¥å£åç§°**: æ›´æ–°çŸ¥è¯†åº“  
**åŠŸèƒ½æè¿°**: æ›´æ–°æŒ‡å®šçŸ¥è¯†åº“çš„ä¿¡æ¯  
**æ¥å£åœ°å€**: `/api/v1/knowledge-bases/{kb_id}`  
**è¯·æ±‚æ–¹å¼**: PUT  
**è®¤è¯**: éœ€è¦Bearer Tokenï¼ˆæ‰€æœ‰è€…æˆ–è¶…çº§ç”¨æˆ·ï¼‰

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|-----|------|--------|
| kb_id | int | æ˜¯ | çŸ¥è¯†åº“IDï¼ˆè·¯å¾„å‚æ•°ï¼‰ | 1 |
| name | string | å¦ | çŸ¥è¯†åº“åç§° | æ›´æ–°çš„åç§° |
| description | string | å¦ | çŸ¥è¯†åº“æè¿° | æ›´æ–°çš„æè¿° |
| visibility | string | å¦ | å¯è§æ€§ï¼ˆpublic/privateï¼‰ | public |

#### å“åº”å‚æ•°
```json
{
  "id": 1,
  "name": "æ›´æ–°çš„åç§°",
  "description": "æ›´æ–°çš„æè¿°",
  "knowledge_type": "general",
  "visibility": "public",
  "owner_id": 1,
  "created_at": "2024-01-01T12:00:00Z",
  "updated_at": "2024-01-01T13:00:00Z"
}
```

#### é”™è¯¯ç 
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `403`: æ— æƒä¿®æ”¹æ­¤çŸ¥è¯†åº“

---

### 5. åˆ é™¤çŸ¥è¯†åº“

**æ¥å£åç§°**: åˆ é™¤çŸ¥è¯†åº“  
**åŠŸèƒ½æè¿°**: è½¯åˆ é™¤æŒ‡å®šçš„çŸ¥è¯†åº“  
**æ¥å£åœ°å€**: `/api/v1/knowledge-bases/{kb_id}`  
**è¯·æ±‚æ–¹å¼**: DELETE  
**è®¤è¯**: éœ€è¦Bearer Tokenï¼ˆæ‰€æœ‰è€…æˆ–è¶…çº§ç”¨æˆ·ï¼‰

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|-----|------|--------|
| kb_id | int | æ˜¯ | çŸ¥è¯†åº“IDï¼ˆè·¯å¾„å‚æ•°ï¼‰ | 1 |

#### å“åº”å‚æ•°
```json
{
  "message": "çŸ¥è¯†åº“å·²åˆ é™¤"
}
```

#### é”™è¯¯ç 
- `404`: çŸ¥è¯†åº“ä¸å­˜åœ¨
- `403`: æ— æƒåˆ é™¤æ­¤çŸ¥è¯†åº“

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´çŸ¥è¯†åº“ç®¡ç†æµç¨‹
```bash
# 1. è·å–çŸ¥è¯†åº“åˆ—è¡¨
curl -X GET "http://localhost:8000/api/v1/knowledge-bases/?page=1&size=20" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# 2. åˆ›å»ºçŸ¥è¯†åº“
curl -X POST "http://localhost:8000/api/v1/knowledge-bases/" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æˆ‘çš„çŸ¥è¯†åº“",
    "description": "è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªçŸ¥è¯†åº“",
    "is_public": false
  }'

# 3. è·å–çŸ¥è¯†åº“è¯¦æƒ…
curl -X GET "http://localhost:8000/api/v1/knowledge-bases/1" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# 4. æ›´æ–°çŸ¥è¯†åº“
curl -X PUT "http://localhost:8000/api/v1/knowledge-bases/1" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æ›´æ–°çš„çŸ¥è¯†åº“åç§°",
    "description": "æ›´æ–°çš„æè¿°",
    "visibility": "public"
  }'

# 5. åˆ é™¤çŸ¥è¯†åº“
curl -X DELETE "http://localhost:8000/api/v1/knowledge-bases/1" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### æœç´¢å’Œè¿‡æ»¤
```bash
# æŒ‰åç§°æœç´¢çŸ¥è¯†åº“
curl -X GET "http://localhost:8000/api/v1/knowledge-bases/?search=æŠ€æœ¯æ–‡æ¡£" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# æŒ‰ç±»å‹è¿‡æ»¤çŸ¥è¯†åº“
curl -X GET "http://localhost:8000/api/v1/knowledge-bases/?knowledge_type=general" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# ç»„åˆæŸ¥è¯¢
curl -X GET "http://localhost:8000/api/v1/knowledge-bases/?page=1&size=10&search=æ–‡æ¡£&knowledge_type=general" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

## ğŸ”’ æƒé™æ§åˆ¶

### å¯è§æ€§è§„åˆ™
1. **ç§æœ‰çŸ¥è¯†åº“ï¼ˆprivateï¼‰**: åªæœ‰æ‰€æœ‰è€…å’Œè¶…çº§ç”¨æˆ·å¯ä»¥è®¿é—®
2. **å…¬å¼€çŸ¥è¯†åº“ï¼ˆpublicï¼‰**: æ‰€æœ‰æœ‰è¯»å–æƒé™çš„ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®

### æ“ä½œæƒé™
1. **åˆ›å»º**: éœ€è¦ `knowledge_base:write` æƒé™
2. **è¯»å–**: éœ€è¦ `knowledge_base:read` æƒé™ + å¯è§æ€§æ£€æŸ¥
3. **æ›´æ–°**: éœ€è¦æ˜¯æ‰€æœ‰è€…æˆ–è¶…çº§ç”¨æˆ·
4. **åˆ é™¤**: éœ€è¦æ˜¯æ‰€æœ‰è€…æˆ–è¶…çº§ç”¨æˆ·

### å®¡è®¡æ—¥å¿—
ç³»ç»Ÿä¼šè®°å½•æ‰€æœ‰çŸ¥è¯†åº“è®¿é—®æ“ä½œçš„å®¡è®¡æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- ç”¨æˆ·IDå’Œç”¨æˆ·å
- æ“ä½œç±»å‹ï¼ˆread/write/deleteï¼‰
- èµ„æºID
- æ“ä½œæ—¶é—´
- æ“ä½œç»“æœ

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **åç§°å”¯ä¸€æ€§**: åŒä¸€ç”¨æˆ·ä¸‹çš„çŸ¥è¯†åº“åç§°å¿…é¡»å”¯ä¸€
2. **è½¯åˆ é™¤**: åˆ é™¤æ“ä½œé‡‡ç”¨è½¯åˆ é™¤ï¼Œæ•°æ®ä¸ä¼šç«‹å³ç‰©ç†åˆ é™¤
3. **æƒé™æ£€æŸ¥**: æ‰€æœ‰æ“ä½œéƒ½ä¼šè¿›è¡Œä¸¥æ ¼çš„æƒé™æ£€æŸ¥
4. **åˆ†é¡µé™åˆ¶**: åˆ—è¡¨æŸ¥è¯¢æœ€å¤§æ¯é¡µ100æ¡è®°å½•
5. **æœç´¢åŠŸèƒ½**: æ”¯æŒæŒ‰çŸ¥è¯†åº“åç§°è¿›è¡Œæ¨¡ç³Šæœç´¢
6. **ç±»å‹ç®¡ç†**: çŸ¥è¯†åº“ç±»å‹ç›®å‰æ”¯æŒ general ç±»å‹ï¼Œåç»­å¯æ‰©å±•
