<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´§å¸æ¢ç®—å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .main-content {
            padding: 40px;
        }

        .converter-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 1.1em;
        }

        .currency-input {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .amount-input {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }

        .amount-input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .currency-select {
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1.1em;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .currency-select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .swap-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 1.5em;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }

        .swap-btn:hover {
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .convert-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
            font-weight: 600;
        }

        .convert-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 172, 254, 0.3);
        }

        .result-section {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .result-amount {
            font-size: 2.5em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .result-info {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 15px;
        }

        .copy-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin: 0 auto;
            display: inline-block;
        }

        .copy-btn:hover {
            background: #219a52;
            transform: translateY(-1px);
        }

        .history-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .history-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 600;
        }

        .history-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #4facfe;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .history-conversion {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .history-rate {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .history-time {
            color: #95a5a6;
            font-size: 0.8em;
            float: right;
        }

        .clear-history {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .clear-history:hover {
            background: #c0392b;
        }

        .currency-symbol {
            font-weight: bold;
            color: #4facfe;
        }

        .rate-display {
            background: rgba(79, 172, 254, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin-top: 15px;
            text-align: center;
            font-size: 0.9em;
            color: #2c3e50;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }

            .converter-section, .history-section {
                padding: 20px;
            }

            .currency-input {
                flex-direction: column;
            }

            .amount-input, .currency-select {
                width: 100%;
                min-width: auto;
            }

            .result-amount {
                font-size: 2em;
            }

            .header h1 {
                font-size: 2em;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(400px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’± è´§å¸æ¢ç®—å·¥å…·</h1>
            <p>æ”¯æŒå¤šç§è´§å¸å®æ—¶æ¢ç®—ï¼Œç®€å•æ˜“ç”¨</p>
        </div>

        <div class="main-content">
            <div class="converter-section">
                <div class="input-group">
                    <label>ä»</label>
                    <div class="currency-input">
                        <input type="number" id="fromAmount" class="amount-input" placeholder="è¾“å…¥é‡‘é¢" step="0.01" min="0">
                        <select id="fromCurrency" class="currency-select">
                            <option value="CNY">ğŸ‡¨ğŸ‡³ äººæ°‘å¸ (CNY)</option>
                            <option value="USD">ğŸ‡ºğŸ‡¸ ç¾å…ƒ (USD)</option>
                            <option value="EUR">ğŸ‡ªğŸ‡º æ¬§å…ƒ (EUR)</option>
                            <option value="GBP">ğŸ‡¬ğŸ‡§ è‹±é•‘ (GBP)</option>
                            <option value="JPY">ğŸ‡¯ğŸ‡µ æ—¥å…ƒ (JPY)</option>
                        </select>
                    </div>
                </div>

                <button class="swap-btn" id="swapBtn" title="äº¤æ¢è´§å¸">â‡…</button>

                <div class="input-group">
                    <label>åˆ°</label>
                    <div class="currency-input">
                        <input type="number" id="toAmount" class="amount-input" placeholder="è½¬æ¢ç»“æœ" readonly>
                        <select id="toCurrency" class="currency-select">
                            <option value="CNY">ğŸ‡¨ğŸ‡³ äººæ°‘å¸ (CNY)</option>
                            <option value="USD" selected>ğŸ‡ºğŸ‡¸ ç¾å…ƒ (USD)</option>
                            <option value="EUR">ğŸ‡ªğŸ‡º æ¬§å…ƒ (EUR)</option>
                            <option value="GBP">ğŸ‡¬ğŸ‡§ è‹±é•‘ (GBP)</option>
                            <option value="JPY">ğŸ‡¯ğŸ‡µ æ—¥å…ƒ (JPY)</option>
                        </select>
                    </div>
                </div>

                <button class="convert-btn" id="convertBtn">ğŸ’± ç«‹å³æ¢ç®—</button>

                <div class="rate-display" id="rateDisplay" style="display: none;">
                    <span id="rateInfo"></span>
                </div>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <div class="result-amount" id="resultAmount"></div>
                <div class="result-info" id="resultInfo"></div>
                <button class="copy-btn" id="copyBtn">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
            </div>

            <div class="history-section">
                <div class="history-title">ğŸ“Š æ¢ç®—è®°å½•</div>
                <div id="historyList">
                    <p style="text-align: center; color: #7f8c8d; padding: 20px;">æš‚æ— æ¢ç®—è®°å½•</p>
                </div>
                <button class="clear-history" id="clearHistoryBtn" style="display: none;">ğŸ—‘ï¸ æ¸…ç©ºè®°å½•</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // æ±‡ç‡æ•°æ® (åŸºäºè¿‘æœŸæ±‡ç‡ï¼Œä»¥USDä¸ºåŸºå‡†)
        const exchangeRates = {
            USD: 1,
            CNY: 7.25,
            EUR: 0.85,
            GBP: 0.73,
            JPY: 110.50
        };

        // è´§å¸ç¬¦å·
        const currencySymbols = {
            USD: '$',
            CNY: 'Â¥',
            EUR: 'â‚¬',
            GBP: 'Â£',
            JPY: 'Â¥'
        };

        // è´§å¸åç§°
        const currencyNames = {
            USD: 'ç¾å…ƒ',
            CNY: 'äººæ°‘å¸',
            EUR: 'æ¬§å…ƒ',
            GBP: 'è‹±é•‘',
            JPY: 'æ—¥å…ƒ'
        };

        // DOM å…ƒç´ 
        const fromAmount = document.getElementById('fromAmount');
        const toAmount = document.getElementById('toAmount');
        const fromCurrency = document.getElementById('fromCurrency');
        const toCurrency = document.getElementById('toCurrency');
        const convertBtn = document.getElementById('convertBtn');
        const swapBtn = document.getElementById('swapBtn');
        const copyBtn = document.getElementById('copyBtn');
        const resultSection = document.getElementById('resultSection');
        const resultAmount = document.getElementById('resultAmount');
        const resultInfo = document.getElementById('resultInfo');
        const rateDisplay = document.getElementById('rateDisplay');
        const rateInfo = document.getElementById('rateInfo');
        const historyList = document.getElementById('historyList');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const notification = document.getElementById('notification');

        // æ¢ç®—å†å²è®°å½•
        let conversionHistory = JSON.parse(localStorage.getItem('currencyHistory')) || [];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            displayHistory();
            
            // å®æ—¶æ¢ç®—
            fromAmount.addEventListener('input', function() {
                if (this.value) {
                    convertCurrency();
                } else {
                    toAmount.value = '';
                    hideResult();
                }
            });

            fromCurrency.addEventListener('change', function() {
                if (fromAmount.value) {
                    convertCurrency();
                }
            });

            toCurrency.addEventListener('change', function() {
                if (fromAmount.value) {
                    convertCurrency();
                }
            });
        });

        // è´§å¸æ¢ç®—å‡½æ•°
        function convertCurrency() {
            const amount = parseFloat(fromAmount.value);
            const from = fromCurrency.value;
            const to = toCurrency.value;

            if (!amount || amount <= 0) {
                showNotification('è¯·è¾“å…¥æœ‰æ•ˆçš„é‡‘é¢', 'error');
                return;
            }

            if (from === to) {
                toAmount.value = amount.toFixed(2);
                showResult(amount, from, to, 1);
                return;
            }

            // è½¬æ¢ä¸ºUSDï¼Œå†è½¬æ¢ä¸ºç›®æ ‡è´§å¸
            const usdAmount = amount / exchangeRates[from];
            const convertedAmount = usdAmount * exchangeRates[to];
            const rate = exchangeRates[to] / exchangeRates[from];

            toAmount.value = convertedAmount.toFixed(2);
            showResult(convertedAmount, from, to, rate);
            showRate(from, to, rate);
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(amount, from, to, rate) {
            const fromSymbol = currencySymbols[from];
            const toSymbol = currencySymbols[to];
            const fromName = currencyNames[from];
            const toName = currencyNames[to];

            resultAmount.innerHTML = `<span class="currency-symbol">${toSymbol}</span>${amount.toFixed(2)}`;
            resultInfo.textContent = `${parseFloat(fromAmount.value).toFixed(2)} ${fromName} = ${amount.toFixed(2)} ${toName}`;
            resultSection.style.display = 'flex';
        }

        // éšè—ç»“æœ
        function hideResult() {
            resultSection.style.display = 'none';
            rateDisplay.style.display = 'none';
        }

        // æ˜¾ç¤ºæ±‡ç‡
        function showRate(from, to, rate) {
            const fromSymbol = currencySymbols[from];
            const toSymbol = currencySymbols[to];
            rateInfo.textContent = `æ±‡ç‡: 1 ${from} = ${rate.toFixed(4)} ${to}`;
            rateDisplay.style.display = 'block';
        }

        // äº¤æ¢è´§å¸
        swapBtn.addEventListener('click', function() {
            const tempCurrency = fromCurrency.value;
            const tempAmount = fromAmount.value;
            
            fromCurrency.value = toCurrency.value;
            toCurrency.value = tempCurrency;
            
            if (toAmount.value) {
                fromAmount.value = toAmount.value;
                convertCurrency();
            } else {
                fromAmount.value = tempAmount;
                if (tempAmount) {
                    convertCurrency();
                }
            }
        });

        // è½¬æ¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        convertBtn.addEventListener('click', function() {
            if (!fromAmount.value) {
                showNotification('è¯·è¾“å…¥è¦æ¢ç®—çš„é‡‘é¢', 'error');
                fromAmount.focus();
                return;
            }
            
            convertCurrency();
            addToHistory();
        });

        // å¤åˆ¶ç»“æœ
        copyBtn.addEventListener('click', function() {
            const result = `${fromAmount.value} ${fromCurrency.value} = ${toAmount.value} ${toCurrency.value}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(result).then(() => {
                    showNotification('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                }).catch(() => {
                    fallbackCopy(result);
                });
            } else {
                fallbackCopy(result);
            }
        });

        // å¤‡ç”¨å¤åˆ¶æ–¹æ³•
        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showNotification('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            } catch (err) {
                showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
            }
            document.body.removeChild(textArea);
        }

        // æ·»åŠ åˆ°å†å²è®°å½•
        function addToHistory() {
            const amount = parseFloat(fromAmount.value);
            const from = fromCurrency.value;
            const to = toCurrency.value;
            const result = parseFloat(toAmount.value);
            const rate = exchangeRates[to] / exchangeRates[from];
            
            const historyItem = {
                id: Date.now(),
                fromAmount: amount,
                fromCurrency: from,
                toAmount: result,
                toCurrency: to,
                rate: rate,
                timestamp: new Date().toLocaleString('zh-CN')
            };

            conversionHistory.unshift(historyItem);
            
            // åªä¿ç•™æœ€è¿‘5æ¡è®°å½•
            if (conversionHistory.length > 5) {
                conversionHistory = conversionHistory.slice(0, 5);
            }

            localStorage.setItem('currencyHistory', JSON.stringify(conversionHistory));
            displayHistory();
        }

        // æ˜¾ç¤ºå†å²è®°å½•
        function displayHistory() {
            if (conversionHistory.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">æš‚æ— æ¢ç®—è®°å½•</p>';
                clearHistoryBtn.style.display = 'none';
                return;
            }

            let historyHTML = '';
            conversionHistory.forEach(item => {
                const fromSymbol = currencySymbols[item.fromCurrency];
                const toSymbol = currencySymbols[item.toCurrency];
                
                historyHTML += `
                    <div class="history-item">
                        <div class="history-time">${item.timestamp}</div>
                        <div class="history-conversion">
                            <span class="currency-symbol">${fromSymbol}</span>${item.fromAmount.toFixed(2)} ${item.fromCurrency} 
                            â†’ <span class="currency-symbol">${toSymbol}</span>${item.toAmount.toFixed(2)} ${item.toCurrency}
                        </div>
                        <div class="history-rate">æ±‡ç‡: 1 ${item.fromCurrency} = ${item.rate.toFixed(4)} ${item.toCurrency}</div>
                    </div>
                `;
            });

            historyList.innerHTML = historyHTML;
            clearHistoryBtn.style.display = 'block';
        }

        // æ¸…ç©ºå†å²è®°å½•
        clearHistoryBtn.addEventListener('click', function() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ¢ç®—è®°å½•å—ï¼Ÿ')) {
                conversionHistory = [];
                localStorage.removeItem('currencyHistory');
                displayHistory();
                showNotification('å†å²è®°å½•å·²æ¸…ç©º');
            }
        });

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = 'notification show';
            
            if (type === 'error') {
                notification.style.background = '#e74c3c';
            } else {
                notification.style.background = '#27ae60';
            }

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && fromAmount.value) {
                convertCurrency();
                addToHistory();
            }
            
            if (e.ctrlKey && e.key === 'c' && resultSection.style.display === 'flex') {
                copyBtn.click();
            }
        });

        // æ•°å­—æ ¼å¼åŒ–
        function formatNumber(num) {
            return new Intl.NumberFormat('zh-CN', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(num);
        }

        // é˜²æŠ–å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // åº”ç”¨é˜²æŠ–åˆ°å®æ—¶æ¢ç®—
        const debouncedConvert = debounce(convertCurrency, 300);
        fromAmount.addEventListener('input', function() {
            if (this.value) {
                debouncedConvert();
            } else {
                toAmount.value = '';
                hideResult();
            }
        });
    </script>
</body>
</html>