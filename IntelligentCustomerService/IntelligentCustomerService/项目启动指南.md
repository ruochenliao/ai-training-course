# ğŸš€ æ™ºèƒ½å®¢æœç³»ç»Ÿå‡çº§ç‰ˆ - é¡¹ç›®å¯åŠ¨æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯åŸºäºç°æœ‰æ™ºèƒ½å®¢æœç³»ç»Ÿçš„å…¨é¢å‡çº§ç‰ˆæœ¬ï¼Œé›†æˆäº†AutoGenæ™ºèƒ½ä½“æ¡†æ¶ã€å¤šæ¨¡æ€å¤§æ¨¡å‹ã€Milvuså‘é‡æ•°æ®åº“ç­‰å…ˆè¿›æŠ€æœ¯ï¼Œæä¾›ä¼ä¸šçº§çš„æ™ºèƒ½å®¢æœè§£å†³æ–¹æ¡ˆã€‚

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

### åŸºç¡€ç¯å¢ƒ
- **Python**: 3.11+
- **Node.js**: 18.0+
- **Docker**: 20.0+ (å¯é€‰)
- **Git**: 2.30+

### æ•°æ®åº“ç¯å¢ƒ
- **MySQL**: 8.0+ (ç”Ÿäº§ç¯å¢ƒ)
- **SQLite**: 3.35+ (å¼€å‘ç¯å¢ƒ)
- **Milvus**: 2.3+
- **Neo4j**: 5.0+
- **Redis**: 7.0+

### ç¡¬ä»¶è¦æ±‚
- **å†…å­˜**: æœ€ä½8GBï¼Œæ¨è16GB+
- **å­˜å‚¨**: æœ€ä½50GBå¯ç”¨ç©ºé—´
- **GPU**: å¯é€‰ï¼Œç”¨äºæœ¬åœ°æ¨¡å‹æ¨ç†åŠ é€Ÿ

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
cd D:/ai-training-course/IntelligentCustomerService
git pull origin main  # æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
```

### 2. ç¯å¢ƒé…ç½®

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨uvï¼ˆæ¨èï¼‰
```bash
# å®‰è£…uvåŒ…ç®¡ç†å™¨
pip install uv

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
.\venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# å®‰è£…ä¾èµ–
uv pip install -r requirements-upgrade.txt
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨pip
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
.\venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# å‡çº§pip
pip install --upgrade pip

# å®‰è£…ä¾èµ–
pip install -r requirements-upgrade.txt
```

### 3. æ•°æ®åº“é…ç½®

#### 3.1 MySQLé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p
CREATE DATABASE intelligent_customer_service CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'ics_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON intelligent_customer_service.* TO 'ics_user'@'localhost';
FLUSH PRIVILEGES;
```

#### 3.2 Milvusé…ç½®
```bash
# ä½¿ç”¨Dockerå¯åŠ¨Milvus
docker run -d --name milvus-standalone \
  -p 19530:19530 \
  -p 9091:9091 \
  -v milvus_data:/var/lib/milvus \
  milvusdb/milvus:v2.3.0 \
  milvus run standalone
```

#### 3.3 Neo4jé…ç½®
```bash
# ä½¿ç”¨Dockerå¯åŠ¨Neo4j
docker run -d --name neo4j \
  -p 7474:7474 -p 7687:7687 \
  -e NEO4J_AUTH=neo4j/your_password \
  -v neo4j_data:/data \
  neo4j:5.0
```

#### 3.4 Redisé…ç½®
```bash
# ä½¿ç”¨Dockerå¯åŠ¨Redis
docker run -d --name redis \
  -p 6379:6379 \
  -v redis_data:/data \
  redis:7.0 redis-server --appendonly yes
```

### 4. ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š
```env
# åº”ç”¨é…ç½®
APP_NAME=æ™ºèƒ½å®¢æœç³»ç»Ÿå‡çº§ç‰ˆ
APP_VERSION=2.0.0
DEBUG=True
SECRET_KEY=your_secret_key_here

# æ•°æ®åº“é…ç½®
DATABASE_URL=mysql://ics_user:your_password@localhost:3306/intelligent_customer_service
SQLITE_URL=sqlite:///./app.db

# Milvusé…ç½®
MILVUS_HOST=localhost
MILVUS_PORT=19530
MILVUS_USER=
MILVUS_PASSWORD=

# Neo4jé…ç½®
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_password

# Redisé…ç½®
REDIS_URL=redis://localhost:6379/0

# æ¨¡å‹APIé…ç½®
DEEPSEEK_API_KEY=your_deepseek_api_key
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1

QWEN_API_KEY=your_qwen_api_key
QWEN_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1

# ModelScopeé…ç½®
MODELSCOPE_CACHE_DIR=./models
MODELSCOPE_TOKEN=your_modelscope_token

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_FILE=./logs/app.log
```

### 5. æ•°æ®åº“åˆå§‹åŒ–

```bash
# è¿è¡Œæ•°æ®åº“è¿ç§»
python -m aerich init -t app.settings.TORTOISE_ORM
python -m aerich init-db
python -m aerich migrate
python -m aerich upgrade

# åˆå§‹åŒ–å‘é‡æ•°æ®åº“
python scripts/init_vector_db.py

# åˆå§‹åŒ–å›¾æ•°æ®åº“
python scripts/init_graph_db.py
```

### 6. æ¨¡å‹ä¸‹è½½å’Œé…ç½®

```bash
# ä¸‹è½½åµŒå…¥æ¨¡å‹å’Œé‡æ’æ¨¡å‹
python scripts/download_models.py

# éªŒè¯æ¨¡å‹é…ç½®
python scripts/verify_models.py
```

### 7. å¯åŠ¨æœåŠ¡

#### å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨åç«¯æœåŠ¡
python run.py

# æˆ–ä½¿ç”¨uvicorn
uvicorn app.main:app --host 0.0.0.0 --port 9999 --reload
```

#### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨gunicornå¯åŠ¨
gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:9999
```

### 8. å‰ç«¯å¯åŠ¨

#### Vue3ç®¡ç†åå°
```bash
cd web
pnpm install
pnpm dev
```

#### ReactèŠå¤©ç•Œé¢
```bash
cd web-react
pnpm install
pnpm dev
```

## ğŸ”§ é…ç½®è¯´æ˜

### æ¨¡å‹é…ç½®

åœ¨ `app/settings/model_config.py` ä¸­é…ç½®æ¨¡å‹å‚æ•°ï¼š

```python
MODEL_CONFIG = {
    "llm_models": {
        "deepseek-chat": {
            "api_key": "your_api_key",
            "base_url": "https://api.deepseek.com/v1",
            "default_params": {
                "temperature": 0.7,
                "max_tokens": 2048
            }
        }
    },
    "multimodal_models": {
        "qwen-vl-max": {
            "api_key": "your_api_key", 
            "base_url": "https://dashscope.aliyuncs.com/compatible-mode/v1"
        }
    },
    "embedding_models": {
        "qwen3-0.6b": {
            "model_name": "Qwen/Qwen3-0.6B",
            "cache_dir": "./models",
            "device": "cpu"  # æˆ– "cuda"
        }
    },
    "rerank_models": {
        "qwen3-reranker": {
            "model_name": "Qwen/Qwen3-Reranker-0.6B",
            "cache_dir": "./models",
            "device": "cpu"
        }
    }
}
```

### æ™ºèƒ½ä½“é…ç½®

åœ¨ `app/settings/agent_config.py` ä¸­é…ç½®æ™ºèƒ½ä½“å‚æ•°ï¼š

```python
AGENT_CONFIG = {
    "chat_agent": {
        "system_message": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ™ºèƒ½å®¢æœåŠ©æ‰‹...",
        "max_history_length": 20,
        "temperature": 0.7
    },
    "knowledge_agent": {
        "search_top_k": 5,
        "rerank_top_k": 3,
        "similarity_threshold": 0.7
    },
    "tool_agent": {
        "enabled_tools": ["ecommerce", "search", "file"],
        "timeout": 30
    }
}
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
curl http://localhost:9999/api/v1/health

# æ£€æŸ¥æ¨¡å‹æœåŠ¡
curl http://localhost:9999/api/v1/models/health

# æ£€æŸ¥å‘é‡æ•°æ®åº“
curl http://localhost:9999/api/v1/knowledge/health
```

### 2. åŠŸèƒ½æµ‹è¯•
```bash
# æµ‹è¯•èŠå¤©æ¥å£
curl -X POST http://localhost:9999/api/v1/chat/chat \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your_token" \
  -d '{"message": "ä½ å¥½ï¼Œæˆ‘æƒ³äº†è§£ä¸€ä¸‹äº§å“ä¿¡æ¯"}'

# æµ‹è¯•æµå¼èŠå¤©
curl -X POST http://localhost:9999/api/v1/chat/stream \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your_token" \
  -d '{"message": "ä½ å¥½", "stream": true}'
```

### 3. è¿è¡Œæµ‹è¯•å¥—ä»¶
```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit/

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
pytest tests/e2e/
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f logs/access.log
```

### æ€§èƒ½ç›‘æ§
- è®¿é—® http://localhost:9999/metrics æŸ¥çœ‹PrometheusæŒ‡æ ‡
- ä½¿ç”¨Grafanaé…ç½®ç›‘æ§é¢æ¿
- æŸ¥çœ‹æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ¨¡å‹ä¸‹è½½å¤±è´¥**
   ```bash
   # æ£€æŸ¥ç½‘ç»œè¿æ¥
   ping modelscope.cn
   
   # æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹
   python scripts/download_models.py --force
   ```

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€
   systemctl status mysql
   systemctl status redis
   docker ps | grep milvus
   ```

3. **å†…å­˜ä¸è¶³**
   ```bash
   # è°ƒæ•´æ¨¡å‹é…ç½®ï¼Œä½¿ç”¨CPUè€ŒéGPU
   # å‡å°‘å¹¶å‘æ•°é‡
   # å¢åŠ è™šæ‹Ÿå†…å­˜
   ```

4. **ç«¯å£å†²çª**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tulpn | grep :9999
   
   # ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£
   ```

### æ—¥å¿—çº§åˆ«è°ƒæ•´
```python
# åœ¨.envæ–‡ä»¶ä¸­è®¾ç½®
LOG_LEVEL=DEBUG  # å¼€å‘ç¯å¢ƒ
LOG_LEVEL=INFO   # ç”Ÿäº§ç¯å¢ƒ
LOG_LEVEL=ERROR  # ä»…é”™è¯¯æ—¥å¿—
```

## ğŸ“š æ›´å¤šèµ„æº

- [APIæ–‡æ¡£](http://localhost:9999/docs)
- [æ¶æ„è®¾è®¡æ–‡æ¡£](æ™ºèƒ½å®¢æœç³»ç»Ÿå®Œæ•´æ¶æ„è®¾è®¡æ–¹æ¡ˆ.md)
- [å·¥ä½œè®¡åˆ’](è¯¦ç»†åˆ†é˜¶æ®µå·¥ä½œè®¡åˆ’.md)
- [å¼€å‘æŒ‡å—](./docs/development-guide.md)
- [éƒ¨ç½²æŒ‡å—](./docs/deployment-guide.md)

## ğŸ¤ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ç¯å¢ƒé…ç½®æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤æ‰€æœ‰ä¾èµ–æœåŠ¡æ­£å¸¸è¿è¡Œ
4. å‚è€ƒæ•…éšœæ’é™¤ç« èŠ‚
5. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

---

**æ³¨æ„**: è¿™æ˜¯å‡çº§ç‰ˆç³»ç»Ÿï¼Œè¯·ç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰è¿›è¡Œå……åˆ†æµ‹è¯•ã€‚
